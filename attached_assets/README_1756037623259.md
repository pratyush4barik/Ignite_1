# Health Assistant Chatbot

A comprehensive health assistant chatbot built with Flask backend and modern frontend, featuring AI integration for general health questions and clinic recommendations from a CSV database.

## Features

### Core Functionality
- **Health Assessment**: Step-by-step symptom collection (symptoms, duration, severity, age, district)
- **Department Mapping**: Intelligent mapping of symptoms to medical departments
- **Clinic Recommendations**: Search and display of healthcare providers from CSV database
- **Crisis Detection**: Emergency situation detection with immediate alerts
- **AI Integration**: Support for OpenAI, Gemini, and MGX APIs for general health questions
- **Session Management**: Persistent conversation history and user data

### Safety Features
- Medical disclaimer prominently displayed
- Emergency keyword detection and immediate response
- Alert logging for crisis situations
- Clear boundaries between AI assistance and medical advice

## Tech Stack

- **Backend**: Python Flask with SQLAlchemy
- **Frontend**: HTML, CSS, JavaScript
- **Database**: SQLite (configurable)
- **AI APIs**: OpenAI GPT-3.5, Google Gemini, MGX
- **Data Storage**: CSV for clinic information
- **Dependencies**: Flask-CORS, Flask-Migrate, Pandas, Requests

## Installation

1. **Clone and navigate to the project**:
   ```bash
   cd /workspace/flask_template
   ```

2. **Install dependencies**:
   ```bash
   pip install -r requirements.txt
   ```

3. **Set up environment variables**:
   Edit the `.env` file and add your API keys:
   ```
   SECRET_KEY=your-secret-key-here
   DATABASE_URL=sqlite:///app.db
   OPENAI_API_KEY=your-openai-api-key-here
   MGX_API_KEY=your-mgx-api-key-here
   GEMINI_API_KEY=your-gemini-api-key-here
   AI_PROVIDER=openai  # or 'gemini' or 'mgx'
   ```

4. **Run the application**:
   ```bash
   python app.py
   ```

5. **Access the chatbot**:
   Open your browser and go to `http://localhost:5000`

## Configuration

### AI Provider Setup
The chatbot supports three AI providers. Set the `AI_PROVIDER` environment variable to:
- `openai` - Uses OpenAI GPT-3.5 Turbo
- `gemini` - Uses Google Gemini Pro
- `mgx` - Uses MGX API (update endpoint in routes.py)

### Clinic Data
Clinic information is stored in `data/clinics.csv` with the following columns:
- clinic_name
- district  
- address
- department
- doctor_name
- doctor_qualification
- doctor_speciality
- timings
- contact_number

Add or modify clinic data by editing this CSV file.

## API Endpoints

### Main Routes
- `GET /` - Main chat interface
- `POST /chat` - Send message and get response
- `POST /reset/<session_id>` - Reset chat session
- `GET /health` - Health check endpoint
- `GET /admin/alerts` - View emergency alerts (admin)

### Chat API Usage
```javascript
fetch('/chat', {
    method: 'POST',
    headers: {'Content-Type': 'application/json'},
    body: JSON.stringify({
        message: "I have a headache",
        session_id: "unique-session-id"
    })
})
```

## Department Mapping
The system automatically maps symptoms to medical departments:

- **General Physician**: fever, cough, flu, cold, headache
- **Cardiology**: chest pain, breathing issues, heart problems
- **Orthopedics**: bone pain, fractures, joint/muscle issues
- **Dermatology**: skin problems, rashes, acne
- **Gastroenterology**: stomach issues, digestion problems
- **Ophthalmology**: eye and vision problems
- **ENT**: ear, nose, throat issues
- **Gynecology**: women's health issues
- **Psychiatry**: mental health concerns
- **Pediatrics**: children's health (based on age)

## Emergency Detection
The system monitors for emergency keywords and triggers immediate responses:
- Suicidal thoughts or self-harm mentions
- Severe symptoms (chest pain, breathing difficulty)
- Poisoning or overdose
- Stroke or heart attack symptoms

## Database Schema

- **ChatSession**: Stores conversation history and user data
- **Alert**: Logs emergency situations
- **User**: Basic user information (extensible)

## Customization

### Adding New Symptoms/Departments
Edit the `SYMPTOM_DEPARTMENT_MAP` in `app/routes.py`:
```python
SYMPTOM_DEPARTMENT_MAP = {
    'new_symptom': 'New Department',
    # ... existing mappings
}
```

### Modifying Emergency Keywords
Update the `EMERGENCY_KEYWORDS` list in `app/routes.py`:
```python
EMERGENCY_KEYWORDS = [
    'existing_keyword',
    'your_new_keyword',
    # ... other keywords
]
```

## Security Considerations

- API keys stored in environment variables
- Input validation on all endpoints
- CORS enabled for frontend communication
- Session-based conversation management
- Emergency alert logging

## Production Deployment

For production deployment:
1. Set `FLASK_DEBUG=False` in environment
2. Use a production WSGI server (gunicorn, uWSGI)
3. Configure a production database (PostgreSQL, MySQL)
4. Set up proper logging and monitoring
5. Implement rate limiting and authentication as needed

## License

This project is for educational and development purposes. Always consult licensed healthcare providers for medical advice.